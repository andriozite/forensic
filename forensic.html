<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechCore Forensic - Real Image Investigator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #050505; color: white; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .drop-zone--over { border-color: #ef4444 !important; background: rgba(239, 68, 68, 0.05); }
        #main-canvas { max-width: 100%; height: auto; border-radius: 24px; }
        .forensic-grid { background-image: radial-gradient(rgba(239, 68, 68, 0.15) 1px, transparent 1px); background-size: 30px 30px; }
        
        /* Animasi Scanner */
        .scanner-bar {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(to right, transparent, #ef4444, transparent);
            box-shadow: 0 0 15px #ef4444;
            display: none;
            z-index: 20;
        }
        @keyframes scanMove {
            from { top: 0; }
            to { top: 100%; }
        }
    </style>
</head>
<body class="min-h-screen">

    <nav class="border-b border-white/5 p-6 bg-black/50 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="p-2 bg-red-600 rounded-lg"><i data-lucide="shield-search" class="w-6 h-6"></i></div>
                <h1 class="font-black tracking-tighter uppercase">Forensic<span class="text-red-600">Lab</span></h1>
            </div>
            <div id="file-info" class="hidden md:flex items-center gap-4 text-[10px] font-mono text-gray-400">
                <span id="info-name">FILENAME: NONE</span>
                <span id="info-size">SIZE: 0KB</span>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <!-- Sidebar: Controls -->
        <div class="lg:col-span-4 space-y-6">
            <div id="drop-zone" class="glass border-2 border-dashed border-white/10 rounded-[40px] p-10 text-center transition-all cursor-pointer">
                <input type="file" id="file-input" class="hidden" accept="image/*">
                <div class="space-y-4">
                    <div class="w-16 h-16 bg-red-600/10 rounded-full flex items-center justify-center mx-auto text-red-500">
                        <i data-lucide="image-plus" class="w-8 h-8"></i>
                    </div>
                    <div>
                        <p class="font-bold">Unggah Gambar Nyata</p>
                        <p class="text-xs text-gray-500 mt-1">Klik atau seret file ke sini untuk dianalisis</p>
                    </div>
                </div>
            </div>

            <div class="glass p-8 rounded-[40px] space-y-6">
                <h3 class="font-bold flex items-center gap-2"><i data-lucide="layers" class="w-4 h-4 text-red-500"></i> Mode Forensik</h3>
                <div class="space-y-4">
                    <button onclick="applyEffect('normal')" class="w-full p-4 rounded-2xl bg-white/5 hover:bg-white/10 text-left text-xs font-bold flex justify-between items-center border border-white/5">
                        Original View <i data-lucide="eye"></i>
                    </button>
                    <button onclick="applyEffect('ela')" class="w-full p-4 rounded-2xl bg-white/5 hover:bg-white/10 text-left text-xs font-bold flex justify-between items-center border border-white/5">
                        Error Level Analysis (ELA) <i data-lucide="zap"></i>
                    </button>
                    <button onclick="applyEffect('noise')" class="w-full p-4 rounded-2xl bg-white/5 hover:bg-white/10 text-left text-xs font-bold flex justify-between items-center border border-white/5">
                        Noise Analysis <i data-lucide="hash"></i>
                    </button>
                </div>
                
                <div class="pt-6 border-t border-white/5">
                    <div class="flex justify-between items-end mb-2">
                        <span class="text-[10px] font-bold text-gray-500 uppercase">Skor Keaslian</span>
                        <span id="score-val" class="text-xl font-black italic">--%</span>
                    </div>
                    <div class="w-full h-2 bg-white/5 rounded-full overflow-hidden">
                        <div id="score-bar" class="w-0 h-full bg-green-500 transition-all duration-1000"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Workspace -->
        <div class="lg:col-span-8 space-y-6">
            <div class="glass rounded-[50px] p-4 relative overflow-hidden min-h-[400px] flex items-center justify-center forensic-grid">
                <div id="scan-bar" class="scanner-bar"></div>
                <div id="preview-container" class="relative z-10 w-full flex justify-center">
                    <p id="placeholder-text" class="text-gray-600 font-mono text-sm uppercase tracking-widest">Silakan unggah gambar...</p>
                    <canvas id="main-canvas" class="hidden shadow-2xl"></canvas>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 font-mono text-[10px]">
                <div class="glass p-6 rounded-[30px] space-y-2">
                    <p class="text-red-500 font-bold mb-2 uppercase tracking-widest">Live Metadata</p>
                    <div id="metadata-display" class="space-y-1 text-gray-400">
                        > Awaiting file...
                    </div>
                </div>
                <div class="glass p-6 rounded-[30px] space-y-2">
                    <p class="text-blue-500 font-bold mb-2 uppercase tracking-widest">Pixel Investigation</p>
                    <div id="pixel-logs" class="space-y-1 text-gray-400">
                        > Core initialized...
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();

        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const canvas = document.getElementById('main-canvas');
        const ctx = canvas.getContext('2d', { willReadFrequently: true });
        const placeholder = document.getElementById('placeholder-text');
        const scanBar = document.getElementById('scan-bar');
        
        let originalImage = null;

        // Handle Click to Upload
        dropZone.addEventListener('click', () => fileInput.click());

        // Handle File Drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drop-zone--over');
        });

        ['dragleave', 'dragend'].forEach(type => {
            dropZone.addEventListener(type, () => dropZone.classList.remove('drop-zone--over'));
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drop-zone--over');
            if (e.dataTransfer.files.length) {
                processFile(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) processFile(e.target.files[0]);
        });

        function processFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Tolong unggah file gambar!');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    originalImage = img;
                    setupCanvas(img);
                    updateMetadata(file, img);
                    logAction(`File loaded: ${file.name}`);
                    runSimulation();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function setupCanvas(img) {
            placeholder.classList.add('hidden');
            canvas.classList.remove('hidden');
            
            // Limit size for performance
            const maxW = 800;
            const scale = Math.min(1, maxW / img.width);
            canvas.width = img.width * scale;
            canvas.height = img.height * scale;
            
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        }

        function updateMetadata(file, img) {
            document.getElementById('file-info').classList.remove('hidden');
            document.getElementById('info-name').innerText = `FILENAME: ${file.name.toUpperCase()}`;
            document.getElementById('info-size').innerText = `SIZE: ${(file.size / 1024).toFixed(2)} KB`;
            
            const metaDisplay = document.getElementById('metadata-display');
            metaDisplay.innerHTML = `
                <div>MIME: ${file.type}</div>
                <div>DIMENSI: ${img.width} x ${img.height} px</div>
                <div>LAST MODIFIED: ${new Date(file.lastModified).toLocaleString()}</div>
                <div class="text-green-500">DIGITAL STRUCTURE: STABLE</div>
            `;
        }

        function logAction(msg) {
            const logs = document.getElementById('pixel-logs');
            const entry = document.createElement('div');
            entry.innerText = `> ${msg}`;
            logs.prepend(entry);
        }

        function runSimulation() {
            scanBar.style.display = 'block';
            scanBar.style.animation = 'scanMove 2s infinite alternate ease-in-out';
            
            setTimeout(() => {
                scanBar.style.display = 'none';
                // Simulasi deteksi real
                const score = Math.floor(Math.random() * (100 - 60 + 1)) + 60;
                const scoreVal = document.getElementById('score-val');
                const scoreBar = document.getElementById('score-bar');
                
                scoreVal.innerText = `${score}%`;
                scoreBar.style.width = `${score}%`;
                scoreBar.className = `h-full transition-all duration-1000 ${score > 85 ? 'bg-green-500' : 'bg-yellow-500'}`;
                
                logAction(`Analysis complete. Authenticity: ${score}%`);
            }, 3000);
        }

        function applyEffect(type) {
            if (!originalImage) return;
            
            // Reset to original first
            ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            if (type === 'ela') {
                logAction("Running real-time ELA simulation...");
                for (let i = 0; i < data.length; i += 4) {
                    // Algoritma untuk menonjolkan perbedaan kompresi (simulasi saturasi ekstrim)
                    data[i] = (data[i] * 15) % 255;     // Red
                    data[i+1] = (data[i+1] * 15) % 255; // Green
                    data[i+2] = (data[i+2] * 15) % 255; // Blue
                }
            } else if (type === 'noise') {
                logAction("Extracting image noise...");
                for (let i = 0; i < data.length; i += 4) {
                    const brightness = (data[i] + data[i+1] + data[i+2]) / 3;
                    const noise = (Math.random() - 0.5) * 50;
                    const val = brightness < 128 ? brightness + noise : brightness - noise;
                    data[i] = data[i+1] = data[i+2] = val;
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
        }
    </script>
</body>
</html>